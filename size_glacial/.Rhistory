MWresults<-cbind(MWx[,"LENGTH"],MWboot[,"LENGTH"],MWx[,"WIDTH"],MWboot[,"WIDTH"],MWx[,"DEPTH"],MWboot[,"DEPTH"],MWx[,"ROBUSTNESS"],MWboot[,"ROBUSTNESS"])
MWresults
colnames(MWresults)<-c("Length.U","Length.p","Width.U","Width.p","Depth.U","Depth.p","Robustness.U","Robustness.p")
MWresults
write.csv(MWresults,paste0(taxon,"MW.csv"))
correction
#significance tests
correction<-0.05/length(levels(age.fac))
KWtest<-array(dim=c(4,4));rownames(KWtest)<-names(data)[-1];colnames(KWtest)<-c("K-W chi-squared","df","p-value",paste0("significant (p<",correction,")"))
for (i in 1:4) {
test<-kruskal.test(data[,i+1],age.fac)
KWtest[i,1:4]<-c(test$statistic,test$parameter,test$p.value,test$p.value<correction)
}
KWtest
for (i in 1:4) {
test<-kruskal.test(data[,i+1],age.fac)
KWtest[i,1:4]<-c(test$statistic,test$parameter,test$p.value,test$p.value<correction)
}
dim(data)
head(data)
data<-subset(data,data$PIT!="AMNH")[,-1]
age.fac<-factor(data$AGE,levels=rev(levels(factor(data$AGE))))
table(data$AGE)
#general form of data processing
#taxon<-"athene"
#data<-read.csv(paste0("csvs/",taxon,"TMT.csv"))
taxon<-"Athene"
path<-"smallbirds/"
data<-read.xlsx(paste0(path,taxon,".xlsx"),1)[,c("PIT","AGE","LENGTH","WIDTH","DEPTH")]
data$ROBUSTNESS<-(data$WIDTH*data$DEPTH)/data$LENGTH
data<-subset(data,data$PIT!="AMNH")[,-1]
age.fac<-factor(data$AGE,levels=rev(levels(factor(data$AGE))))
table(data$AGE)
#basic stats
filename<-paste0(taxon,"_basic.csv")
write.csv(taxon,file=filename)
for(i in 1:3){
suppressWarnings(write(names(data)[i+1],file=filename,append=T))
statblock<-data.frame(Age.ka=levels(age.fac),
N=as.numeric(table(age.fac)),
Mean=as.numeric(by(data[,i+1],age.fac,mean)),
SD=as.numeric(by(data[,i+1],age.fac,sd)))
statblock$CV=statblock$Mean/statblock$SD
suppressWarnings(write.table(statblock,file=filename,append=T,row.names=F))
}
#TS models
dataTS<-make.paleoTS(data,agelookup=F)
TSfit4<-lapply(dataTS,fit4models,pool=F)
TSfit4.wt<-rbind(TSfit4$LENGTH$Akaike.wt,TSfit4$WIDTH$Akaike.wt,TSfit4$DEPTH$Akaike.wt,TSfit4$ROBUSTNESS$Akaike.wt);rownames(TSfit4.wt)<-names(TSfit4);colnames(TSfit4.wt)<-rownames(TSfit4$LENGTH)
write.table(TSfit4.wt,paste0(taxon,"TS.csv"),row.names = F)
#significance tests
correction<-0.05/length(levels(age.fac))
KWtest<-array(dim=c(4,4));rownames(KWtest)<-names(data)[-1];colnames(KWtest)<-c("K-W chi-squared","df","p-value",paste0("significant (p<",correction,")"))
for (i in 1:4) {
test<-kruskal.test(data[,i+1],age.fac)
KWtest[i,1:4]<-c(test$statistic,test$parameter,test$p.value,test$p.value<correction)
}
rownames(KWtest)<-names(data)[-1]
names(data)[-1]
KWtest<-array(dim=c(4,4));rownames(KWtest)<-names(data);colnames(KWtest)<-c("K-W chi-squared","df","p-value",paste0("significant (p<",correction,")"))
KWtest
head(data)
age.fac
age.fac<-factor(data$AGE,levels=rev(levels(factor(data$AGE))))
age.fac
data<-read.xlsx(paste0(path,taxon,".xlsx"),1)[,c("PIT","AGE","LENGTH","WIDTH","DEPTH")]
#general form of data processing
#taxon<-"athene"
#data<-read.csv(paste0("csvs/",taxon,"TMT.csv"))
taxon<-"Athene"
path<-"smallbirds/"
getwd()
#path<-"smallbirds/"
data<-read.xlsx(paste0(path,taxon,".xlsx"),1)[,c("PIT","AGE","LENGTH","WIDTH","DEPTH")]
#path<-"smallbirds/"
#data<-read.xlsx(paste0(path,taxon,".xlsx"),1)[,c("PIT","AGE","LENGTH","WIDTH","DEPTH")]
data<-read.xlsx(paste0(taxon,".xlsx"),1)[,c("PIT","AGE","LENGTH","WIDTH","DEPTH")]
data$ROBUSTNESS<-(data$WIDTH*data$DEPTH)/data$LENGTH
data<-subset(data,data$PIT!="AMNH")[,-1]
age.fac<-factor(data$AGE,levels=rev(levels(factor(data$AGE))))
table(data$AGE)
data
#basic stats
filename<-paste0(taxon,"_basic.csv")
write.csv(taxon,file=filename)
for(i in 1:3){
suppressWarnings(write(names(data)[i+1],file=filename,append=T))
statblock<-data.frame(Age.ka=levels(age.fac),
N=as.numeric(table(age.fac)),
Mean=as.numeric(by(data[,i+1],age.fac,mean)),
SD=as.numeric(by(data[,i+1],age.fac,sd)))
statblock$CV=statblock$Mean/statblock$SD
suppressWarnings(write.table(statblock,file=filename,append=T,row.names=F))
}
#TS models
dataTS<-make.paleoTS(data,agelookup=F)
TSfit4<-lapply(dataTS,fit4models,pool=F)
TSfit4.wt<-rbind(TSfit4$LENGTH$Akaike.wt,TSfit4$WIDTH$Akaike.wt,TSfit4$DEPTH$Akaike.wt,TSfit4$ROBUSTNESS$Akaike.wt);rownames(TSfit4.wt)<-names(TSfit4);colnames(TSfit4.wt)<-rownames(TSfit4$LENGTH)
write.table(TSfit4.wt,paste0(taxon,"TS.csv"),row.names = F)
#significance tests
correction<-0.05/length(levels(age.fac))
correction
names(data[-1])
KWtest<-array(dim=c(4,4));rownames(KWtest)<-names(data[-1]);colnames(KWtest)<-c("K-W chi-squared","df","p-value",paste0("significant (p<",correction,")"))
for (i in 1:4) {
test<-kruskal.test(data[,i+1],age.fac)
KWtest[i,1:4]<-c(test$statistic,test$parameter,test$p.value,test$p.value<correction)
}
KWtest
filename<-paste0(taxon,"KWtest.csv")
write.csv(KWtest,file=filename)
MWboot<-array(dim=c(length(levels(age.fac)),4));colnames(MWboot)<-names(data)[-1];rownames(MWboot)<-levels(age.fac)
for (j in 1:4){
groups<-split(data[,j+1],age.fac)
for (i in 1:length(levels(age.fac))) {
x1<-unlist(groups[i]); x2<-unlist(groups[-i])
MWboot[i,j]<-round(wilcox.test(x1,x2)$p.value,4)
}
}
for(i in 1:length(MWboot)) if(MWboot[i]<correction) MWboot[i]<-paste0(MWboot[i],"*")
MWx<-MWboot
for (j in 1:4){
groups<-split(data[,j+1],age.fac)
for (i in 1:length(levels(age.fac))) {
x1<-unlist(groups[i]); x2<-unlist(groups[-i])
MWx[i,j]<-round(wilcox.test(x1,x2)$statistic,4)
}
}
MWresults<-cbind(MWx[,"LENGTH"],MWboot[,"LENGTH"],MWx[,"WIDTH"],MWboot[,"WIDTH"],MWx[,"DEPTH"],MWboot[,"DEPTH"],MWx[,"ROBUSTNESS"],MWboot[,"ROBUSTNESS"]);colnames(MWresults)<-c("Length.U","Length.p","Width.U","Width.p","Depth.U","Depth.p","Robustness.U","Robustness.p")
MWresults
test
#path<-"smallbirds/"
#data<-read.xlsx(paste0(path,taxon,".xlsx"),1)[,c("PIT","AGE","LENGTH","WIDTH","DEPTH")]
data<-read.xlsx(paste0(taxon,".xlsx"),1)[,c("PIT","AGE","LENGTH","WIDTH","DEPTH")]
apply(AMNH,2,mean)
apply(UCMVZ,2,mean)
?t.test
require(paleoTS);require(xlsx)
taxon<-"Felis_concolor"
path<-"Cats/"
data<-read.xlsx(paste0(path,taxon,".xlsx"),1)[,c("Pit","Age","L","W")]
?read.xlsx
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName="m1")[,c("Pit","Age","L","W")]
View(data)
plot(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W)
plot(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W,xlim=range(data$L),ylim=range(data$W))
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,add=T)
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,pch=2)
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W)
plot(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,add=T,pch-2)
plot(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,add=T,pch=2)
plot(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W,xlim=range(data$L),ylim=range(data$W))
plot(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,add=T,pch=2)
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,pch=2)
plot(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W,xlim=range(data$L),ylim=range(data$W))
warnings()
data
which(data$Age!=0)
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,pch=2)
?pch
plot(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W,xlim=range(data$L),ylim=range(data$W),pch=0)
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,pch=15)
plot(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main="Felis concolor")
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,pch=15)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main="Felis concolor")
points(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W,pch=0)
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,pch=15)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main="Felis concolor m1")
points(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W,pch=0)
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,pch=15)
?hotel2T2
require(Compositional)
install.packages("Compositional")
taxon<-"Felis_concolor"
path<-"Cats/"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName="m1")[,c("Pit","Age","L","W")]
install.packages("Hotelling")
require(Hotelling)
hotelling.test(subset(data,data$Age==0)[,"L","W"],subset(data,data$Age!=0)[,"L","W"])
container
container.df
hotelling.test(subset(data,data$Age==0)[,c("L","W")],subset(data,data$Age!=0)[,c("L","W")])
test<-hotelling.test(subset(data,data$Age==0)[,c("L","W")],subset(data,data$Age!=0)[,c("L","W")])
summary(test)
test
test$stats
test
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste0(taxon,meas))
meas<-"m1"
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste0(taxon,meas))
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(subset(data,data$Age==0)$L,subset(data,data$Age==0)$W,pch=0)
points(subset(data,data$Age!=0)$L,subset(data,data$Age!=0)$W,pch=15)
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
test
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=21)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=21)
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=2-0)
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=0);points(mean(fossil$L),mean(fossil$W),pch=15)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
test
?text
text(18,7,test)
text(18,7,print(test))
test$stats$statistic
text(18,7,c(test$stats$statistic/test$stats$df))
test$stats$df
test$stats$statistic/test$stats$df[1]
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
text(18,7,test$pval)
text(18,7,paste0("p=",round(test$pval,4)))
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
text(18,7,paste0("p=",round(test$pval,4)))
text(18,6.5,paste0("p=",round(test$pval,4)))
text(18,6.5,paste0("means different with p=",round(test$pval,4)))
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
text(18,6.5,paste0("means different with p=",round(test$pval,4)))
par(mfrow=c(3,1))
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
text(18,6.5,paste0("means different with p=",round(test$pval,4)))
par()
?legend
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17))
text("topleft",paste0("means different with p=",round(test$pval,4)))
text("topleft",paste0("means different with p=",round(test$pval,4)))
text
?text
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)))
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17))
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)))
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)),bty=0,cex=0.8)
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)),border="none",cex=0.8)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)),border="none",cex=0.8)
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)),bty="n",cex=0.8)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17))
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)),bty="n",cex=0.8)
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)),bty="n",cex=0.9)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17))
legend("topleft",legend=paste0("means different with p=",round(test$pval,4)),bty="n",cex=0.9)
str(test)
print.hotelling.test
?print.hotelling.test
edit(print.hotelling.test)
prettyprint(test)
print(Test)
print(test)
str(print(test))
printtest<-print(test)
str(printttest)
str(printtest)
print(test$stats)
print(test)
data.frame(print(test))
?capture.output
capture.output(print(Test))
capture.output(print(test))
capture.output(print(test))[1]
capture.output(test)
capture.output(test)[1]
legend("topleft",legend=c("means different",capture.output(test)[1],capture.output(test)[4],bty="n",cex=0.9))
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17))
legend("topleft",legend=c("means different",capture.output(test)[1],capture.output(test)[4],bty="n",cex=0.9))
legend("topleft",legend=c("means different",capture.output(test)[1],capture.output(test)[4]),bty="n",cex=0.9))
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17))
legend("topleft",legend=c("means different",capture.output(test)[1],capture.output(test)[4]),bty="n",cex=0.9))
legend("topleft",legend=c("means different",capture.output(test)[1],capture.output(test)[4]),bty="n",cex=0.9)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17))
legend("topleft",legend=c(capture.output(test)[1],capture.output(test)[4]),bty="n",cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17))
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
path<-"Cats/"
taxon<-"Felis_concolor"
meas<-"m3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
path<-"Cats/"
taxon<-"Felis_concolor"
meas<-"mc3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
path<-"Cats/"
taxon<-"Felis_concolor"
meas<-"mt3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab="m1 length",ylab="m2 length",main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
taxon<-"Lynx_rufus"
meas<-"m1"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
taxon<-"Lynx_rufus"
meas<-"mc3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
taxon<-"Lynx_rufus"
meas<-"mt3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
taxon<-"Panthera_concolor"
meas<-"mc3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
meas<-"m1"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
taxon<-"Panthera_concolor"
meas<-"m1"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
taxon<-"Felis_concolor"
meas<-"m1"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
meas<-"mt3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
taxon<-"Lynx_rufus"
meas<-"mt3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
meas<-"mc3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
meas<-"m1"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
meas<-"mc3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
meas<-"mt3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
taxon<-"Felis_concolor"
meas<-"mt3"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
meas<-"m1"
data<-read.xlsx(paste0(path,taxon,".xlsx"),sheetName=meas)[,c("Pit","Age","L","W")]
modern<-subset(data,data$Age==0)
fossil<-subset(data,data$Age!=0)
test<-hotelling.test(modern[,c("L","W")],fossil[,c("L","W")])
plot(0,0,xlim=range(data$L),ylim=range(data$W),pch=0,xlab=paste(meas,"length"),ylab=paste(meas,"width"),main=paste(taxon,meas))
points(modern$L,modern$W,pch=1);points(mean(modern$L),mean(modern$W),pch=16)
points(fossil$L,fossil$W,pch=2);points(mean(fossil$L),mean(fossil$W),pch=17)
legend("bottomright",legend=c("modern","modern mean","fossil","fossil mean"),pch=c(1,16,2,17),cex=0.9)
legend("topleft",legend=c(paste("Hotelling T2",capture.output(test)[1]),capture.output(test)[4]),bty="n",cex=0.9)
dim(data)
cov(data$L,data$W)
cor(data$L,data$W)
