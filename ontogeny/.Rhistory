}
write("",file="results.txt")
if (require("xlsx",warn.conflicts=FALSE)==FALSE) {
install.packages("xlsx",repos="http://cran.cnr.berkeley.edu/");
library("xlsx");
}
if (require("smatr",warn.conflicts=FALSE)==FALSE) {
install.packages("smatr",repos="http://cran.cnr.berkeley.edu/");
library("smatr");
}
options(stringsAsFactors = FALSE,encoding="UTF-8")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
write("---- X=LN(LENGTH), Y=LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
write(paste("RMA results,",date()),file="results.txt",append=T)
write("---- X=LN(LENGTH), Y=LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames<-c("Kilbourne_Felis_silvestris.xlsx","Kilbourne_Leptailurus_serval.xlsx","Kilbourne_Panthera_tigris.xlsx","Kilbourne_Puma_concolor.xlsx")
dataNames<-c("Length","Circumference")
boneNames<-c("Femur","Tibia","Humerus","Radius")
write(paste("RMA results,",date()),file="results.txt",append=T)
write("---- X=LN(LENGTH), Y=LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
write("---- X=LN(LENGTH), Y=LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
write(paste("RMA results,",date()),file="results.txt",append=T)
write("---- X=LN(LENGTH), Y=LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
write(paste("RMA results,",date()),file="results.txt",append=T)
write("---- X=LN(LENGTH), Y=LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames<-"Kilbourne_Puma_concolor.xlsx"
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames
data
dataNames
plot(data$Length,data$Circumference)
?abline
abline(25,1)
abline(30,1)
plot(data$Length,data$Circumference,xlim=c(0,210)
)
plot(data$Length,data$Circumference,ylim=c(0,65))
abline(20,1)
plot(log(data$Length),log(data$Circumference))
plot(log(data$Length),log(data$Circumference),ylim=c(0,4.2))
plot(log(data$Length),log(data$Circumference),ylim=c(0,5.5),xlim=c(0,5.5))
abline(0,1)
abline(-1,1)
abline(-1.2,1)
abline(-1.3,1)
plot(log(data$Length),log(data$Circumference),ylim=c(0,5.5),xlim=c(0,5.5))
abline(-1.3,1)
testData<-read.xlsx("Kilbourne_Felis_silvestris",sheetIndex = 1)
testData<-read.xlsx("Kilbourne_Felis_silvestris.xlsx",sheetIndex = 1)
cor.test
testData
plot(testData$Length,testData$Circumference)
plot(testData$Length,testData$Circumference,xlim=c(0,125))
abline(0,1)
abline(-0.62,1.6)
plot(log(testData$Length),log(testData$Circumference))
abline(-0.62,1.6)
abline(0,1)
abline(-0.62,1)
abline(-0.62,1/1.6)
plot(lm(log(testData$Circumference)~log(testData$Length)))
plot(log(testData$Length),log(testData$Circumference))
lm(log(testData$Circumference)~log(testData$Length))
sma(log(testData$Length)~log(testData$Circumference)
)
fileNames<-c("SmilodonRMA.xlsx","AtroxRMA.xlsx")
dataNames<-c("LENGTH","CIRCUMF"
)
boneNames<-c("Femur","Tibia","Humerus","Radius")
write(paste("RMA results,",date()),file="results.txt",append=T)
write("---- LN(LENGTH) ~ LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
write("---- LN(LENGTH) ~ LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
plot(log(testData$Circumference),log(testData$Length))
abline(-0.62,1/1.6)
testData
sma(log(testData$Length)~log(testData$Circumference)
)
sma(log(testData$Circumference)~log(testData$Length))
abline(-0.62,1.6)
Smilodon<-read.xlsx("SmilodonRMA.xlsx",sheetIndex=1)
plot(log(Smilodon$CIRCUMF),log(Smilodon$LENGTH))
sma(log(Smilodon$LENGTH)~log(Smilodon$CIRCUMF))
abline(-1.91,1.65)
?text
text(x=3.9,y=5.8,pos=4,labels="y = -1.91 + 1.65x")
text(x=3.9,y=5.7,pos=4,labels="Smilodon, humeri")
fileNames<-c("Paramylodon.xlsx")
dataNames<-c("LENGTH","CIRCUMF","WIDTH","DEPTH","AREA")
boneNames<-c("Femur","Tibia","Humerus","Radius","Ulna")
if (require("xlsx",warn.conflicts=FALSE)==FALSE) {
install.packages("xlsx",repos="http://cran.cnr.berkeley.edu/");
library("xlsx");
}
if (require("smatr",warn.conflicts=FALSE)==FALSE) {
install.packages("smatr",repos="http://cran.cnr.berkeley.edu/");
library("smatr");
}
options(stringsAsFactors = FALSE,encoding="UTF-8")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
write("---- LN(LENGTH) ~ LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
warnings()
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
write("---- LN(LENGTH) ~ LN(CIRCUMFERENCE) ----",file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
boneNames<-c("Femur","Tibia","Humerus","Radius")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
boneNames<-c("Femur","Tibia","Humerus","Radius","Ulna")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames<-c("Camelops.xlsx")
boneNames<-c("Femur","Tibia","Humerus","Radius")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames<-c("Camelops.xlsx")
dataNames<-c("LENGTH","CIRCUMF")
boneNames<-c("Femur","Tibia","Humerus","Radius")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames<-c("Paramylodon.xlsx")
boneNames<-c("Femur","Tibia","Humerus","Radius","Ulna")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],dataNames[1],"~",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames<-c("Camelops.xlsx")
boneNames<-c("Femur","Tibia","Humerus","Radius")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(x)~log(y),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
?sma
fileNames<-c("Camelops.xlsx")
write("",file="results.txt")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
dataNames<-c("LENGTH","CIRCUMF")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames<-c("Paramylodon.xlsx")
boneNames<-c("Femur","Tibia","Humerus","Radius","Ulna")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
fileNames<-c("Paramylodon.xlsx")
dataNames<-c("CIRCUMF","LENGTH")
boneNames<-c("Femur","Tibia","Humerus","Radius","Ulna")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
boneNames<-c("Femur","Tibia","Humerus","Radius")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
boneNames<-c("Ulna")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
