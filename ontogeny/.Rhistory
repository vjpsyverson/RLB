for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
if (require("xlsx",warn.conflicts=FALSE)==FALSE) {
install.packages("xlsx",repos="http://cran.cnr.berkeley.edu/");
library("xlsx");
}
if (require("smatr",warn.conflicts=FALSE)==FALSE) {
install.packages("smatr",repos="http://cran.cnr.berkeley.edu/");
library("smatr");
}
options(stringsAsFactors = FALSE,encoding="UTF-8")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
if (require("xlsx",warn.conflicts=FALSE)==FALSE) {
install.packages("xlsx",repos="http://cran.cnr.berkeley.edu/");
library("xlsx");
}
if (require("smatr",warn.conflicts=FALSE)==FALSE) {
install.packages("smatr",repos="http://cran.cnr.berkeley.edu/");
library("smatr");
}
options(stringsAsFactors = FALSE,encoding="UTF-8")
fileNames<-c("EquusJuveniles.xlsx")
dataNames<-c("CIRCUMF","LENGTH")
boneNames<-c("Femur","Tibia","Humerus","Radius")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
?cor.test
data
str(data)
data<-read.xlsx(fileNames,"Tibia")
data
head(data)
plot(data$LENGTH.,data$CIRCUMF)
plot(data$CIRCUMF,data$LENGTH)
plot(log(data$CIRCUMF),log(data$LENGTH))
lm(log(data$LENGTH)~log(data$CIRCUMF))
?abline
abline(2.105,.725)
plot(log(data$CIRCUMF),log(data$LENGTH),main="Equus tibia")
abline(2.105,.725)
data<-read.xlsx(fileNames,"Radius")
plot(log(data$CIRCUMF),log(data$LENGTH))
plot(log(data$CIRCUMF),log(data$LENGTH),main="Equus radius")
abline(-0.224,1.119)
lm(log(data$LENGTH~data$CIRCUMF))
data$LENGTH
data$CIRCUMF
lm(log(data$LENGTH)~log(data$CIRCUMF))
plot(lm(log(data$LENGTH)~log(data$CIRCUMF)))
plot(log(data$CIRCUMF),log(data$LENGTH),main="Equus radius")
plot(summary(lm(log(data$LENGTH)~log(data$CIRCUMF))))
abline(2.3486,0.6726)
head(data)
test<-sma(log(data$LENGTH)~log(data$CIRCUMF))
test
dataNames
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
result$name
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
x
y
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
result$corr.p.value
RMA<-sma(log(y)~log(x),data=data)
RMA
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
result
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
data<-read.xlsx(fileNames[i],sheetIndex=j)
data
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
j
boneNames[4]
data<-read.xlsx(fileNames[i],sheetIndex=j)
k
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
result
head(data)
x
y
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
result
data
data$LENGTH
data$CIRCUMF
cor.test(data$LENGTH,data$CIRCUMF,method = "spearman")
RMA<-sma(log(y)~log(x),data=data)
RMA
plot(log(y)~log(x))
points(data$LENGTH~data$CIRCUMF,pch=21)
points(data$LENGTH~data$CIRCUMF,pch=20)
points(log(data$LENGTH)~log(data$CIRCUMF),pch=20)
boneNames[4]
fileNames[1]
#
write("",file="results.txt")
#
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
}
}
}
result
result$RMA.coef
result$RMA.coef$`coef(SMA)`[1]
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(fileNames[i],boneNames[j]))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
par(mfrow=c(2,2)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
par(mfrow=c(2,2)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetIndex=j)
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
?read.xlsx
boneNames<-c("Femur","Tibia","Radius","Humerus")
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
fileNames<-c("La Brea Bison.xlsx")
dataNames<-c("CIRCUMF","LENGTH")
boneNames<-c("Femur","Tibia","Radius","Humerus")
dataNames<-c("length","circumference")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
fileNames<-c("Camelops.xlsx")
dataNames<-c("LENGTH","CIRCUMF")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
boneNames<-c("Femur","Tibia","Radius","Humerus","Ulna")
par(mfrow=c(3,2)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
fileNames<-c("Paramylodon.xlsx")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
par(mfrow=c(3,2)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
par(mfrow=c(2,3)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
boneNames<-c("Femur","Tibia","Humerus","Ulna")
dataNames<-c("DIAPHYSIS","CIRCUMF")
par(mfrow=c(2,4)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
data
i
j
k
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
fileNames<-c("M_exilis.xlsx","M_columbi.xlsx")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
dataNames<-c("CIRCUMF","DIAPHYSIS")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
