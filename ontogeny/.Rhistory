for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
fileNames<-c("La Brea Bison.xlsx")
dataNames<-c("CIRCUMF","LENGTH")
boneNames<-c("Femur","Tibia","Radius","Humerus")
dataNames<-c("length","circumference")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
fileNames<-c("Camelops.xlsx")
dataNames<-c("LENGTH","CIRCUMF")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
boneNames<-c("Femur","Tibia","Radius","Humerus","Ulna")
par(mfrow=c(3,2)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
fileNames<-c("Paramylodon.xlsx")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
par(mfrow=c(3,2)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
par(mfrow=c(2,3)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
boneNames<-c("Femur","Tibia","Humerus","Ulna")
dataNames<-c("DIAPHYSIS","CIRCUMF")
par(mfrow=c(2,4)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
data
i
j
k
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
fileNames<-c("M_exilis.xlsx","M_columbi.xlsx")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
dataNames<-c("CIRCUMF","DIAPHYSIS")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
if (require("xlsx",warn.conflicts=FALSE)==FALSE) {
install.packages("xlsx",repos="http://cran.cnr.berkeley.edu/");
library("xlsx");
}
if (require("smatr",warn.conflicts=FALSE)==FALSE) {
install.packages("smatr",repos="http://cran.cnr.berkeley.edu/");
library("smatr");
}
options(stringsAsFactors = FALSE,encoding="UTF-8")
boneNames<-c("Tibia","Humerus","Ulna")
dataNames<-c("CIRCUMFERENCE","DIAPHYSIS")
fileNames<-c("Rerun_M_exilis.xlsx","Rerun_M_columbi.xlsx")
par(mfrow=c(1,2)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
fileNames<-c("Rerun_M_exilis.xlsx","Rerun_M_columbi.xlsx")
boneNames<-c("TIBIA","HUMERUS","ULNA")
#
write("",file="results.txt")
#
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
par(mfrow=c(2,3)) #change as necessary
write("",file="results.txt")
#
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
fileNames<-c("Rerun_M_exilis.xlsx","Rerun_M_columbi.xlsx")
i<-2
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
fileNames<-c("Rerun_M_exilis.xlsx","Rerun_M_columbi.xlsx")
par(mfrow=c(2,3)) #change as necessary
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
i<-1
par(mfrow=c(2,3)) #change as necessary
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
write("",file="results.txt")
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
write("",file="results.txt")
par(mfrow=c(2,3)) #change as necessary
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
if (require("xlsx",warn.conflicts=FALSE)==FALSE) {
install.packages("xlsx",repos="http://cran.cnr.berkeley.edu/");
library("xlsx");
}
if (require("smatr",warn.conflicts=FALSE)==FALSE) {
install.packages("smatr",repos="http://cran.cnr.berkeley.edu/");
library("smatr");
}
options(stringsAsFactors = FALSE,encoding="UTF-8")
par(mfrow=c(1,3)) #change as necessary
fileNames<-c("Rerun_Mammuthus.xlsx")
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
write("",file="results.txt")
#
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
par(mfrow=c(1,3)) #change as necessary
#
write("",file="results.txt")
#
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
write("",file="results.txt")
write(paste("RMA results,",date()),file="results.txt",append=T)
for(i in 1:length(fileNames)){
for(j in 1:length(boneNames)){
data<-read.xlsx(fileNames[i],sheetName=boneNames[j])
for(k in 2:length(dataNames)){
result<-list()
result$name<-paste(fileNames[i],boneNames[j],"X=",dataNames[1],", Y=",dataNames[k])
x<-eval(parse(text=paste0("data$",dataNames[1])))
y<-eval(parse(text=paste0("data$",dataNames[k])))
result$corr.p.value<-cor.test(x,y,method="spearman")$p.value
RMA<-sma(log(y)~log(x),data=data)
result$RMA.coef<-RMA$coef[[1]]
result$RMA.r2<-RMA$r2[[1]][1]
result$RMA.p.value<-RMA$pval[[1]][1]
capture.output(result,file="results.txt",append=T)
plot(log(y)~log(x),main=paste(boneNames[j],"-",fileNames[i]),xlab=paste0("Ln(",dataNames[1],")"),ylab=paste0("Ln(",dataNames[k],")"))
abline(result$RMA.coef$`coef(SMA)`[1],result$RMA.coef$`coef(SMA)`[2])
}
}
}
